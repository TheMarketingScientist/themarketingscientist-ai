<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andres Acosta">
<meta name="dcterms.date" content="2025-02-10">
<meta name="description" content="We start by diving into one of the most important pillars of a successful AI Strategy.">

<title> The pillars of AI Strategy and Transformation  Part 1: Business Priorities </title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="AI Transformation and Strategy Framework Business Priorities_files/libs/clipboard/clipboard.min.js"></script>
<script src="AI Transformation and Strategy Framework Business Priorities_files/libs/quarto-html/quarto.js"></script>
<script src="AI Transformation and Strategy Framework Business Priorities_files/libs/quarto-html/popper.min.js"></script>
<script src="AI Transformation and Strategy Framework Business Priorities_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="AI Transformation and Strategy Framework Business Priorities_files/libs/quarto-html/anchor.min.js"></script>
<link href="AI Transformation and Strategy Framework Business Priorities_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="AI Transformation and Strategy Framework Business Priorities_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="AI Transformation and Strategy Framework Business Priorities_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="AI Transformation and Strategy Framework Business Priorities_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="AI Transformation and Strategy Framework Business Priorities_files/libs/bootstrap/bootstrap-a1ff8711b79ae3724c050874b28d9907.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="../style.css">
<link rel="stylesheet" href="../article.css">
</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><br><br><br><br><br><br>The pillars of AI Strategy and Transformation<br> Part 1: Business Priorities<br><br></h1>
</div>

<div>
  <div class="description">
    We start by diving into one of the most important pillars of a successful AI Strategy.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andres Acosta </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<header class="site-header">
    <h1 class="site-title">The Marketing Scientist</h1>
    <nav class="site-nav">
        <a href="../index.html" class="nav-link">üè† Home</a>
        <a href="../articles.html" class="nav-link">üìö Articles</a>
    </nav>
</header>
<section id="the-seven-layer-framework-for-ai-strategy-success" class="level1">
<h1>The Seven-Layer Framework for AI Strategy Success</h1>
<p>AI is the most transformative technological shifts in today‚Äôs business landscape. Research shows that <strong>49% of leaders struggle to demonstrate the value of their AI initiatives</strong>, with these percentages increasing significantly in underdeveloped markets like LATAM and Africa. Success requires not only technical expertise but also a well-structured approach built on fundamental pillars that support sustainable growth.</p>
<section id="overview-of-the-framework" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-the-framework">Overview of the Framework</h2>
<p>My framework provides a structured approach to developing and implementing an effective AI strategy. Each layer builds upon the previous one, creating a <strong>comprehensive foundation for success</strong>. Feedback loops ensure continuous improvement and learning across all phases of the implementation journey.</p>
<p>Each of these layers has its own methodologies, which I‚Äôll discuss in later articles.</p>
</section>
<section id="initial-assessment-layer" class="level2">
<h2 class="anchored" data-anchor-id="initial-assessment-layer">Initial Assessment Layer</h2>
<section id="business-strategic-priorities" class="level3">
<h3 class="anchored" data-anchor-id="business-strategic-priorities">Business Strategic Priorities</h3>
<p>A well-defined AI strategy starts with a <strong>deep understanding of the business‚Äôs strategic priorities</strong>. Without this, AI initiatives risk becoming isolated experiments rather than integrated solutions that drive business value.</p>
<section id="alignment-with-organizational-goals" class="level4">
<h4 class="anchored" data-anchor-id="alignment-with-organizational-goals"><strong>1. Alignment with Organizational Goals</strong></h4>
<p>AI should serve as a catalyst for achieving business objectives, whether they involve <strong>revenue growth, cost reduction, market share expansion or branding</strong>. Leadership buy-in and support on organizational and financial matters is critical for ensuring strategic alignment.</p>
<p>If geographical, vertical or PNL segregation are evident, the organization siloes <strong>must be open</strong> to sharing their goals, priorities, operational concerns ad procedures, and strategic information, while embracing new ways of working and approaching business challenges, without any fear of losing control, power or revenue. If a reliable and clearly recognized governance structure is in place, goal alignment should not be a problem.</p>
<p>As AI Strategists, we go department by department, geography by geography, vertical by vertical and product by product, understanding these elements and identifying requirement patterns that have the potential to improve business performance.</p>
</section>
<section id="market-position-and-competitive-landscape-analysis" class="level4">
<h4 class="anchored" data-anchor-id="market-position-and-competitive-landscape-analysis"><strong>2. Market Position and Competitive Landscape Analysis</strong></h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/projects-okrs.png" class="img-fluid figure-img"></p>
<figcaption>Can an AI initiatve take charge of more than 1 KPI or OKR?</figcaption>
</figure>
</div>
<p>Understanding the company‚Äôs position in the market helps define AI‚Äôs role. Market leaders might use AI for <strong>differentiation through innovation</strong>, while challengers may focus on business performance.</p>
<p>Having at disposal business KPIs and OKRs is key to ensure a measurable AI impact and business outcomes.</p>
<p>üìä <strong>Examples of Critical KPIs to assess AI impact</strong>: - Market Share<br>
- Share of Voice<br>
- Leadership Positioning<br>
- Quality Perception<br>
- Customer Acquisition Costs<br>
- Customer Lifetime Value (CLV)<br>
- Operational Costs and ROI</p>
<p>Within an industry, different companies are commonly well known to have an edge on a particular business aspect like technology, consulting, performance, brand positioning, etc‚Ä¶ Benchmarking against <strong>industry best products and competitors</strong> provides insight into AI-driven differentiation opportunities. The goal is to leverage AI for a <strong>unique advantage</strong> to improve any of the benchmark KPIs.</p>
</section>
<section id="scope-of-present-and-future-client-or-customer-engagements" class="level4">
<h4 class="anchored" data-anchor-id="scope-of-present-and-future-client-or-customer-engagements"><strong>3. Scope of Present and Future Client or Customer Engagements</strong></h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/data-driven.jpeg" class="img-fluid figure-img"></p>
<figcaption>Generate and Decant, as many times as needed!</figcaption>
</figure>
</div>
<p>AI can enhance customer relationships and open new market segments. This is perhaps the most ignored application of basic AI algortihms like those in Supervised Machine Learning. Businesses must explore how AI can <strong>create new value</strong> for their clients and for themselves, embracing change. Businesses can use their hard earned lessons form previous client or customer experiences.</p>
<p>This stage mainly involves a strong brainstorming and incorporation of business prioties and market positioning into the generation of seemlessly viable ideas. Cross-functional and active participation is requried and highly encouraged for a continuous proccess of idea generation and decantation. Set a clear deadline for the completion of this stage and align entrerprise wide communication.</p>
<p>‚ö†Ô∏è <strong>Beware:</strong> Defining a wishlist creates a level of expectation in different departments. Expectation management is crucial moving forward.</p>
</section>
<section id="lessons-learned" class="level4">
<h4 class="anchored" data-anchor-id="lessons-learned"><strong>4. Lessons Learned</strong></h4>
<p>Organizations must document their <strong>past AI and Analytics successes and failures</strong>. This helps refine strategies and <strong>avoid repeating mistakes</strong>, ensuring that AI investments focus on opporutnities with high impact and high probability of success. Provide failure context, business problems that should have been solved, solutions tried and the results obtained.</p>
<p>üí°Even if solutions were not as sucessful as expected, the material, infrastructure, models and data used might be valuable asset for future future business and clients problems and solutions, drastically reducing production costs. If that‚Äôs the case, ensure you have a strured plan to leverage these assets moving forward.</p>
</section>
<section id="long-term-vision-mapping" class="level4">
<h4 class="anchored" data-anchor-id="long-term-vision-mapping"><strong>5. Long-Term Vision Mapping</strong></h4>
<p>AI transformation is a <strong>long-term journey</strong>. A strategic roadmap should outline <strong>where AI will play a role in the next 5 to 10 years</strong>, considering emerging technologies, evolving client and customer needs, and regulatory changes.</p>
<p>Yes, I said 5 to 10 years. Many companies spent the last decade chasing trends rather than investing in AI with longevity. Most have got none to little results:</p>
<p>-üö® Hired AI or Data Science teams only to dismantle them every few months for internal politics reasons or when the hype cycle shifts. -üö® Hesitated to commit to AI as a core capability while simultaneously chasing the latest ‚ÄúAI revolution‚Äù. -üö® Done very little with the data they already have.</p>
<p><strong>Aim to validate your AI inititatives ASAP, but keep in mind it will most probably require iterations, a first failure is not a reason to fire your AI team after 3 months of hiring them and reallocate AI investmetns to other areas in the company.</strong> If you‚Äôre truly concerned about wether a potentialy expensive AI initiative will succeed, set goals for the following 6 and 9 months <strong>after the AI team has been hired and trained.</strong> AI teams need not know the business as you or some of your teams do, they also need input on business context. Do it well.</p>
</section>
<section id="business-uvps-unique-value-propositions" class="level4">
<h4 class="anchored" data-anchor-id="business-uvps-unique-value-propositions"><strong>6. Business UVPs (Unique Value Propositions)</strong></h4>
<p>AI must reinforce the <strong>company‚Äôs unique value proposition</strong>. For example: - A company competing on <strong>efficiency</strong> ‚Üí AI should focus on automation.<br>
- A company competing on <strong>customer experience</strong> ‚Üí AI should focus on hyper-personalization.</p>
<p>The AI capabilities to enhance unique value propositions is the one of the main responsabilities of us AI Strategists. True differentiation steams from data, AI outputs for business decisions, customer and client experience, and revenue. A comprehensive AI strategy has much more in store than you think.</p>
<p>üí°Most companies have a few central products or services, but business opportunities might arise from marginal products and services in which the company is planning to increase investment. Some products or services are also weak spots when compared to industry benchmarks, AI could represent an opportunity for industry parity.</p>
</section>
<section id="business-current-partnerships" class="level4">
<h4 class="anchored" data-anchor-id="business-current-partnerships"><strong>7. ü§ù Business Current Partnerships</strong></h4>
<p>AI strategies are <strong>accelerated by strategic partnerships</strong>. Collaborating with <strong>cloud providers, data vendors, research institutions and AI startups</strong> strengthens AI capabilities and ensures access to the latest innovations.</p>
<p>ü§ù <strong>Potential AI Partnerships</strong>: - Magnificent 6 (Google, Meta, Amazon, Apple, Microsoft, NVIDIA)<br>
- Data vendors (for training AI models)<br>
- Research institutions<br>
- AI startups - Regional recognized data providers.</p>
<p>Some of the best AI transformation opportunities are nurtured by existing but unexplored parterships.</p>
<p>‚ö†Ô∏è Each partnership type requires especific considerations: Partherships need to be managed with care and corporate responsibility. Excessive reliance on partnerships can rerail your business success and threaten its future very quickly and very easily. I‚Äôll write more about this important topic in the future.</p>
</section>
<section id="iteration-patience-proactivity-and-improvement" class="level4">
<h4 class="anchored" data-anchor-id="iteration-patience-proactivity-and-improvement"><strong>Iteration, Patience, Proactivity and Improvement</strong></h4>
<p>A regular review and adaptation of approach ensures alignment with changing market conditions and organizational goals. Success comes from balancing ambitious vision with practical implementation while maintaining focus on delivering measurable value.</p>
<div class="connect-section">
  <div class="linkedin-button">
    <a href="https://www.linkedin.com/in/themarketingscientist" target="_blank">
      <i class="bi bi-linkedin"></i>
      The Marketing Scientist
    </a>
  </div>
</div>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>